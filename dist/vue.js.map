{"version":3,"file":"vue.js","sources":["../utils/type.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === 'function';\r\n}\r\nexport function isObject(val) {\r\n    return val !== null && typeof val === 'object';\r\n}\r\n","//使用类的方式来实现数据劫持，类有类型，检查是否被绑定可以同过检查时候为Observer的实例\r\nimport {isObject} from \"../../utils/type\";\r\nclass Observer{\r\n    constructor(data){//进行数据劫持\r\n       this.walk(data);\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data,key,data[key]);\r\n        })\r\n    }\r\n}\r\nfunction defineReactive(data, key, value) {\r\n    // value有可能是对象递归,这个也是vue2的缺点性能很差 ，如果是数组，数组的每一项也要进行数据劫持\r\n    observer(value)\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            console.log('get', key);\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            console.log('set', key);\r\n            if (newValue !== value) {\r\n                observer(newValue);\r\n                value = newValue;\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport  function observer (data){\r\n    if(!isObject(data)){\r\n        return;\r\n    }\r\n    return new Observer(data);\r\n\r\n}\r\n","import {observer} from \"./observer/index\";\r\nimport {isFunction} from \"../utils/type\";\r\n\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    if (opts.props) {\r\n        initProps(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm,opts.data);\r\n    }\r\n    // if (opts.computed) {\r\n    //     initComputed(vm, opts.computed);\r\n    // }\r\n    // if (opts.watch) {\r\n    //     initWatch(vm, opts.watch);\r\n    // }\r\n\r\n}\r\nfunction initData(vm,data){\r\n    //vue2通过Object.defineProperty来实现数据劫持\r\n    typeof isFunction(data) && (data=vm._data = data.call(vm));//将data的值赋值给vm._data，data和vm._data都执行被劫持的值\r\n    observer(data)\r\n    //vue3通过proxy来实现数据劫持\r\n    console.log('initData',data)\r\n    // const keys = Object.keys(data);\r\n    // let i = keys.length;\r\n    // while (i--) {\r\n    //     proxy(vm, `_data`, keys[i]);\r\n    // }\r\n    // observe(data);\r\n}\r\n\r\n","import { initState } from './state';\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;//window.vm.$options = options 为了全局都能访问到options\r\n        // 初始化状态\r\n        initState(vm);\r\n        // 如果用户传入了el属性 需要将页面渲染出来\r\n        // if (vm.$options.el) {\r\n        //     vm.$mount(vm.$options.el);\r\n        // }\r\n    };\r\n}\r\n","import {initMixin} from './init.js'\r\n\r\nfunction Vue(options){\r\n    this._init(options);\r\n}\r\n\r\ninitMixin(Vue)\r\nexport default Vue\r\n"],"names":["isFunction","val","isObject","_typeof","Observer","data","_classCallCheck","walk","_createClass","key","value","Object","keys","forEach","defineReactive","observer","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","props","initProps","initData","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}