{"version":3,"file":"vue.js","sources":["../utils/type.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/compiler/index.js","../src/compiler/generator.js","../src/compiler/parser.js","../src/lifecycle.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === 'function';\r\n}\r\nexport function isObject(val) {\r\n    return val !== null && typeof val === 'object';\r\n}\r\n","export const originArrayMethods=Object.create(Array.prototype);\r\nlet methods=['push','shift','unshift','pop','reverse','sort','splice']\r\nmethods.forEach((item)=>{\r\n    originArrayMethods[item]=function (...args) {\r\n        console.log('数组方法被调用了')\r\n         originArrayMethods[item].call(this,...args)\r\n        const ob=this.__ob__;\r\n        let inserted;\r\n        switch (item) {\r\n            case 'push':\r\n            case 'unshift':a\r\n                inserted=args;\r\n                break;\r\n            case 'splice':\r\n                inserted=args.slice(2);//获取splice第三个参数，才是新增的元素\r\n            default:break\r\n            if(inserted){\r\n                ob.observer(inserted)\r\n            }\r\n        }\r\n    }\r\n})\r\n","//使用类的方式来实现数据劫持，类有类型，检查是否被绑定可以同过检查时候为Observer的实例\r\nimport {isObject} from \"../../utils/type\";\r\nimport {originArrayMethods} from \"./array\";\r\n//1.如果是对象，进行递归，如果是数组，进行数组的方法重写\r\n//2.如果是对象，需要对对象的每一个属性进行数据劫持\r\nclass Observer{\r\n    constructor(data){//进行数据劫持\r\n       // data.__ob__=this 会导致循环引用\r\n        Object.defineProperty(data,'__ob__',{//写成不可枚举的属性，避免循环引用\r\n            value:this,\r\n            enumerable:false\r\n        })\r\n        if(Array.isArray(data)){\r\n            data.__prot__=originArrayMethods\r\n            observerArray(data)\r\n        }\r\n       this.walk(data);\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data,key,data[key]);\r\n        })\r\n    }\r\n}\r\nfunction observerArray(data){\r\n    data.forEach(item=>{\r\n        observer(item)\r\n    })\r\n}\r\nfunction defineReactive(data, key, value) {\r\n    // value有可能是对象递归,这个也是vue2的缺点性能很差 ，如果是数组，数组的每一项也要进行数据劫持\r\n    observer(value)\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            console.log('get', key);\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            console.log('set', key);\r\n            if (newValue !== value) {\r\n                observer(newValue);\r\n                value = newValue;\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport  function observer (data){\r\n    if(!isObject(data)){//如果不是对象，就不用观测了观察数组也就是到这里递归结束\r\n        return;\r\n    }\r\n    if(data.__ob__)return //如果已经被观测过了，就不要再次观测了\r\n    return new Observer(data);\r\n\r\n}\r\n","import {observer} from \"./observer/index\";\r\nimport {isFunction} from \"../utils/type\";\r\n\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    if (opts.props) {\r\n        initProps(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm,opts.data);\r\n    }\r\n    // if (opts.computed) {\r\n    //     initComputed(vm, opts.computed);\r\n    // }\r\n    // if (opts.watch) {\r\n    //     initWatch(vm, opts.watch);\r\n    // }\r\n\r\n}\r\nfunction initData(vm,data){\r\n    //vue2通过Object.defineProperty来实现数据劫持\r\n    typeof isFunction(data) && (data=vm._data = data.call(vm));//将data的值赋值给vm._data，data和vm._data都执行被劫持的值\r\n    observer(data)\r\n    //vue3通过proxy来实现数据劫持\r\n    console.log('initData',data)\r\n    // const keys = Object.keys(data);\r\n    // let i = keys.length;\r\n    // while (i--) {\r\n    //     proxy(vm, `_data`, keys[i]);\r\n    // }\r\n    // observe(data);\r\n}\r\n\r\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名称\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // 用来获取的标签名的 match 结果，例如：<my:xx>\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配开始标签的\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配闭合标签的\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的键值对 id='app' id=\"app\" id=app\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配 {{ xxx }}\r\n\r\n\r\nlet root=null\r\nlet stack=[]\r\nfunction start(tagName, attrs) {\r\n    let element = createASTElement(tagName, attrs);\r\n    if (!root) {\r\n        root = element;\r\n    }\r\n    let currentParent =stack[stack.length-1]\r\n    if (currentParent) {\r\n        element.parent = currentParent;\r\n        currentParent.children.push(element);\r\n    }\r\n    stack.push(element);\r\n}\r\n\r\nfunction end(endTag) {\r\n    let element = stack.pop();\r\n    let currentParent = stack[stack.length - 1];\r\n    if(element.tagName!==endTag){\r\n        throw new Error(endTag+'标签错误')\r\n    }\r\n    if (currentParent) {\r\n        element.parent = currentParent;\r\n        currentParent.children.push(element);\r\n    }\r\n}\r\n\r\nfunction chars(text) {\r\n    text = text.replace(/\\s/g, '');\r\n    let currentParent =stack[stack.length-1]\r\n    if (text) {\r\n        currentParent.children.push({\r\n            type: 3,\r\n            text\r\n        });\r\n    }\r\n}\r\nfunction createASTElement(tagName,attrs){\r\n    return{\r\n        tagName,\r\n        type:1,\r\n        children:[],\r\n        parent:null,\r\n        attrs\r\n    }\r\n}\r\nexport function parseHTML(html) {\r\n    function advance(n){\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],//这个是标签名例如div start[0]是<div\r\n                attrs: []\r\n            };\r\n            advance(start[0].length);\r\n            let end, attr;\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {//截去匹配后，不是结尾标签并且是属性，继续匹配\r\n                advance(attr[0].length);\r\n                match.attrs.push({ name: attr[1], value: attr[3]||attr[4]||attr[5] });//attr[1] attr[3]是属性的key-value键值对\r\n            }\r\n            if (end) {\r\n                advance(end[0].length);\r\n                return match;\r\n            }\r\n        }\r\n    }\r\n    while (html) {\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {//当前文本开头是<符号，一种是开始标签，一种是结束标签\r\n            const startTagMatch = parseStartTag();//解析开始标签\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            const endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n        }\r\n        let text;\r\n        if (textEnd > 0) {\r\n            text = html.substring(0, textEnd);//123</div>\r\n        }\r\n        if (text) {\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n    }\r\n    return root\r\n}\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g//[\"{{test}}\",\"test\"]\r\nexport function generator(root) {\r\n    console.log('generator', root)\r\n    let code = `_c('${root.tag}',${root.attrs.length ? `{${genProps(root.attrs)}}` : 'undefined'}\r\n    ${root.children ? `,${genChildren(root.children)}` : ''})`\r\n    return code\r\n}\r\n\r\nfunction genProps(attrs) {\r\n    let str = ''\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') {//处理style属性\r\n            let styleObj = {}\r\n            attr.value.split(';').forEach(item => {\r\n                let [key, value] = item.split(':')\r\n                styleObj[key] = value\r\n            })\r\n            attr.value = styleObj\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)}`\r\n        if (i < attrs.length - 1) {\r\n            str += ','\r\n        }\r\n    }\r\n    console.log('genProps', str)\r\n    return str\r\n}\r\n\r\nfunction genChildren(el) {\r\n    let children = el.children;\r\n    if (children) {\r\n        return children.map(c => gen(c)).join(',')\r\n    } else {\r\n        return false\r\n    }\r\n}\r\n\r\nfunction gen(el) {\r\n    if (el.type === 1) {//如果是元素，则递归生成子元素element=1 text=3\r\n        return generate(el)\r\n    } else {\r\n        let text = el.text;\r\n        if (!defaultTagRE.test(text)) {//如果是普通文本\r\n            return `_v(${text})`\r\n        }else {\r\n            //hello {{name}} hello {{age}}=> hello +name+ hello + age\r\n            let tokens = [];\r\n            let match, index;\r\n            let lastIndex  =defaultTagRE.lastIndex= 0;//正则的exec和正则的/g冲突，需要手动设置lastIndex\r\n            while (match = defaultTagRE.exec(text)) {//看有没有匹配到\r\n                index = match.index;//匹配到的开始索引\r\n                if (index > lastIndex) {//hello// 匹配到了\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`);//JSON.stringify=_s()\r\n                lastIndex = index + match[0].length;\r\n            }\r\n            if (lastIndex < text.length) {//大括号匹配完了，但是字符串还有剩余\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n\r\n    }\r\n\r\n}\r\n//_c('div',{},hello) eval可以将字符串转成函数但是性能不好\r\n","import {parseHTML} from \"./index\";\r\nimport {generator} from \"./generator\";\r\n\r\nexport function compileToFunctions(template) {\r\n    let root=parseHTML(template);\r\n    console.log('root',root)\r\n    let code=generator(root)\r\n    console.log('code',code)\r\n    let render=new Function( `with(this){return ${code}}` );//with(this)将this中的数据全部放到函数作用域中\r\n   // let render = new Function(`with(this){return ${code}}`);\r\n     // html=>ast语法树=>render函数=>虚拟dom(增加额外属性)=>真实dom\r\n    console.log('render',render)\r\n}\r\nfunction render( ast){\r\n\r\n}\r\n// {}\r\n","export function mountComponent(vm,el){\r\n    let updateComponent=()=>{//更新函数，数据变化后会再次调用此函数\r\n         vm._render();//生成虚拟dom\r\n        vm._update();//虚拟dom转换成真实dom\r\n    }\r\n    updateComponent()\r\n\r\n}\r\n","import { initState } from './state';\r\nimport {compileToFunctions} from \"./compiler/parser\";\r\nimport {mountComponent} from \"./lifecycle\";\r\nimport{createTextVnode,createElement} from \"./vdom/index\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;//window.vm.$options = options 为了全局都能访问到options\r\n        // 初始化状态\r\n        initState(vm);\r\n        // 如果用户传入了el属性 需要将页面渲染出来,把数据挂载到页面上\r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el);\r\n        }\r\n    };\r\n    Vue.prototype.$mount = function (el) {\r\n        console.log('mount')\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        el = document.querySelector(el);\r\n        if (!options.render) {\r\n            let template = options.template;\r\n            if (!template && el) {//没有模板就就用el中的内容\r\n                template = el.outerHTML;\r\n            }\r\n            const render = compileToFunctions(template);//将模板编译成render函数\r\n            options.render = render;\r\n        }\r\n        mountComponent(vm, el);//组件挂载\r\n    }\r\n}\r\nexport  function renderMixin(Vue) {\r\n    Vue.prototype._c = function () {//创建元素的虚拟节点\r\n        return createElement(this,...arguments);\r\n    }\r\n    Vue.prototype._s = function (val) {//将数据转换成字符串\r\n        return val == null ? '' : (typeof val === 'object') ? JSON.stringify(val) : val;\r\n    }\r\n    Vue.prototype._v = function (text) {//创建文本的虚拟节点\r\n        return createTextVnode(this,text);\r\n    }\r\n    Vue.prototype._render = function () {\r\n        const vm = this;\r\n        const {render} = vm.$options;\r\n        let vnode = render.call(vm);\r\n        return vnode;\r\n    }\r\n}\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        const vm = this;\r\n        vm.$el = patch(vm.$el, vnode);\r\n    }\r\n}\r\n","import {initMixin} from './init.js'\r\n\r\nfunction Vue(options){\r\n    this._init(options);\r\n}\r\n\r\ninitMixin(Vue)//\r\nrenderMixin(Vue)//渲染\r\nlifecycleMixin(Vue)//生命周期\r\nexport default Vue\r\n"],"names":["isFunction","val","isObject","_typeof","originArrayMethods","Object","create","Array","prototype","methods","forEach","item","_originArrayMethods$i","console","log","_len","arguments","length","args","_key","call","apply","concat","__ob__","a","inserted","slice","Observer","data","_classCallCheck","defineProperty","value","enumerable","isArray","__prot__","observerArray","walk","_createClass","key","keys","defineReactive","observer","get","set","newValue","initState","vm","opts","$options","props","initProps","initData","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","stack","start","tagName","attrs","element","createASTElement","currentParent","parent","children","push","end","pop","Error","chars","text","replace","type","parseHTML","html","advance","n","substring","parseStartTag","match","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","generator","code","tag","genProps","genChildren","str","_loop","i","styleObj","split","_item$split","_item$split2","_slicedToArray","JSON","stringify","el","map","c","gen","join","generate","test","tokens","index","lastIndex","exec","trim","compileToFunctions","template","render","Function","mountComponent","updateComponent","_render","_update","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML","renderMixin","lifecycleMixin"],"mappings":"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"}